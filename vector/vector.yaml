api:
  enabled: true
  address: "0.0.0.0:8686"

sources:
  vectorlogs:
    type: internal_logs
    
  dockersyslog:
    type: syslog
    address: '0.0.0.0:5123'
    mode: udp

transforms:
  parse_docker_logs:
    type: remap
    inputs:
      - dockersyslog
    source: |
      .timestamp = now()
      .container = .appname
      del(.appname)

sinks:
  loki_vectorlogs:
    type: loki
    inputs:
      - vectorlogs
    encoding:
      codec: json
    endpoint: 'http://loki:3100'
    labels:
      logsource: vector
    acknowledgements:
      enabled: true

  loki_dockersyslog:
    type: loki
    inputs:
      - parse_docker_logs
    encoding:
      codec: json
    endpoint: 'http://loki:3100'
    labels:
      logsource: docker
      container: "{{ container }}"
    acknowledgements:
      enabled: true
